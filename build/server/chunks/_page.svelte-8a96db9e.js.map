{"version":3,"file":"_page.svelte-8a96db9e.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/multi-day/_category_/_page.svelte.js"],"sourcesContent":["import { c as create_ssr_component, g as add_attribute, e as escape, h as subscribe, y as set_store_value, i as each, v as validate_component } from \"../../../../chunks/index3.js\";\nimport \"svelte-gestures\";\nimport dayjs from \"dayjs\";\nimport { g as getCategoryDatePath, L as LoadingBar, C as Chevron } from \"../../../../chunks/LoadingBar.js\";\nimport { R as ReservationDialog } from \"../../../../chunks/ReservationDialog.js\";\nimport { M as Modal } from \"../../../../chunks/ExclamationCircle.js\";\nimport { a as minValidDateStr } from \"../../../../chunks/reservations.js\";\nimport { c as idx2month, g as getYYYYMMDD } from \"../../../../chunks/datetimeUtils.js\";\nimport { a as view, s as stateLoaded, l as loginState, g as getReservationSummary } from \"../../../../chunks/stores2.js\";\nimport { S as Settings } from \"../../../../chunks/settings.js\";\nimport { a as auth } from \"../../../../chunks/firebase.js\";\nconst DayOfMonth = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let { date } = $$props;\n  let { category } = $$props;\n  let { summary } = $$props;\n  if ($$props.date === void 0 && $$bindings.date && date !== void 0)\n    $$bindings.date(date);\n  if ($$props.category === void 0 && $$bindings.category && category !== void 0)\n    $$bindings.category(category);\n  if ($$props.summary === void 0 && $$bindings.summary && summary !== void 0)\n    $$bindings.summary(summary);\n  return `<div class=\"overflow-hidden h-full\"><a class=\"no-underline\"${add_attribute(\"href\", getCategoryDatePath(category, date), 0)}><div class=\"h-full\"><p class=\"${\"flex justify-center w-6 m-auto \" + escape(dayjs(date).isSame(dayjs(), \"date\") && \"rounded-[50%] bg-stone-300 dark:bg-stone-600\", true)}\">${escape(dayjs(date).get(\"date\"))}</p>\n\t\t\t${summary ? `${category === \"openwater\" && summary.openwater.total ? `<div class=\"${\"mx-auto first-of-type:mt-2 first-of-type:mb-1 flex items-center justify-center text-sm rounded-xl h-6 w-10 md:w-16 px-1 rsv \" + escape(category, true)}\"><span class=\"hidden md:inline\">AM</span>\n\t\t\t\t\t\t+${escape(summary.openwater.AM)}</div>\n\t\t\t\t\t<div class=\"${\"mx-auto first-of-type:mt-2 first-of-type:mb-1 flex items-center justify-center text-sm rounded-xl h-6 w-10 md:w-16 px-1 rsv \" + escape(category, true)}\"><span class=\"hidden md:inline\">PM</span>\n\t\t\t\t\t\t+${escape(summary.openwater.PM)}</div>` : ``}\n\n\t\t\t\t${category === \"pool\" && summary.pool ? `<div class=\"${\"mx-auto mt-4 flex items-center justify-center text-sm rounded-xl h-6 w-10 rsv \" + escape(category, true)}\">+${escape(summary.pool)}</div>` : ``}\n\n\t\t\t\t${category === \"classroom\" && summary.classroom ? `<div class=\"${\"mx-auto mt-4 flex items-center justify-center text-sm rounded-xl h-6 w-10 rsv \" + escape(category, true)}\">+${escape(summary.classroom)}</div>` : ``}` : ``}</div></a></div>`;\n});\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let monthDates;\n  let $view, $$unsubscribe_view;\n  let $stateLoaded, $$unsubscribe_stateLoaded;\n  let $loginState, $$unsubscribe_loginState;\n  $$unsubscribe_view = subscribe(view, (value) => $view = value);\n  $$unsubscribe_stateLoaded = subscribe(stateLoaded, (value) => $stateLoaded = value);\n  $$unsubscribe_loginState = subscribe(loginState, (value) => $loginState = value);\n  let { data } = $$props;\n  set_store_value(view, $view = \"multi-day\", $view);\n  let now = dayjs();\n  let isLoading = false;\n  function getWeeksInMonth(year = now.year(), month = now.month()) {\n    const startOfMonth = dayjs().year(year).month(month).startOf(\"month\");\n    const endOfMonth = startOfMonth.endOf(\"month\");\n    let date = startOfMonth.startOf(\"week\");\n    const weeks = [];\n    while (date <= endOfMonth) {\n      const days = Array(7).fill(0).map((_, i) => date.add(i, \"day\"));\n      weeks.push(days);\n      date = date.add(1, \"week\");\n    }\n    return weeks;\n  }\n  let datesSummary = {};\n  const loadSummary = async () => {\n    if (monthDates.length) {\n      isLoading = true;\n      const firstWeek = monthDates[0];\n      const lastWeek = monthDates[monthDates.length - 1];\n      const data2 = await getReservationSummary(firstWeek[0].toDate(), lastWeek[lastWeek.length - 1].toDate());\n      if (data2 && data2.status === \"success\") {\n        datesSummary = { ...datesSummary, ...data2.summary };\n      }\n      isLoading = false;\n    }\n  };\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0)\n    $$bindings.data(data);\n  monthDates = getWeeksInMonth(now.get(\"year\"), now.get(\"month\"));\n  {\n    {\n      auth.authStateReady().then(() => {\n        monthDates.length && loadSummary();\n      });\n    }\n  }\n  $$unsubscribe_view();\n  $$unsubscribe_stateLoaded();\n  $$unsubscribe_loginState();\n  return `\n\n${isLoading ? `${validate_component(LoadingBar, \"LoadingBar\").$$render($$result, {}, {}, {})}` : ``}\n${$stateLoaded && $loginState === \"in\" ? `<div class=\"[&>*]:mx-auto flex items-center justify-between\"><div class=\"dropdown h-8 mb-4\"><label tabindex=\"0\" class=\"border border-gray-200 dark:border-gray-700 btn btn-fsh-dropdown\">${escape(data.category)}</label>\n\t\t\t<ul tabindex=\"0\" class=\"dropdown-content menu p-0 shadow bg-base-100 rounded-box w-fit\">${each([\"pool\", \"openwater\", \"classroom\"], (cat) => {\n    return `${cat !== data.category ? `<li><a class=\"text-xl active:bg-gray-300\" href=\"${\"/multi-day/\" + escape(cat, true)}\">${escape(cat)}</a>\n\t\t\t\t\t\t</li>` : ``}`;\n  })}</ul></div>\n\t\t<div class=\"inline-flex items-center justify-between\"><span class=\"cursor-pointer\">${validate_component(Chevron, \"Chevron\").$$render($$result, { direction: \"left\", svgClass: \"h-6 w-6\" }, {}, {})}</span>\n\t\t\t<span class=\"cursor-pointer\">${validate_component(Chevron, \"Chevron\").$$render($$result, { direction: \"right\", svgClass: \"h-6 w-6\" }, {}, {})}</span>\n\t\t\t<span class=\"text-2xl\">${escape(idx2month[now.get(\"month\")])}</span></div>\n\t\t<span class=\"\">${validate_component(Modal, \"Modal\").$$render($$result, {}, {}, {\n    default: () => {\n      return `${validate_component(ReservationDialog, \"ReservationDialog\").$$render(\n        $$result,\n        {\n          category: data.category,\n          dateFn: (cat) => minValidDateStr(Settings, cat)\n        },\n        {},\n        {}\n      )}`;\n    }\n  })}</span></div>\n\t<div><table class=\"calendar table-fixed border-collapse w-full\"><thead><tr><th>S</th>\n\t\t\t\t\t<th>M</th>\n\t\t\t\t\t<th>T</th>\n\t\t\t\t\t<th>W</th>\n\t\t\t\t\t<th>T</th>\n\t\t\t\t\t<th>F</th>\n\t\t\t\t\t<th>S</th></tr></thead>\n\t\t\t<tbody>${each(monthDates, (week) => {\n    return `<tr>${each(week, (date) => {\n      return `<td${add_attribute(\"class\", `border-${data.category}-bg-to align-top h-20 xs:h-24 border border-solid ${!date.isSame(now, \"month\") && \"opacity-20 border-opacity-20\"}`, 0)}>${validate_component(DayOfMonth, \"DayOfMonth\").$$render(\n        $$result,\n        {\n          date: date.toDate(),\n          category: data.category,\n          summary: datesSummary[getYYYYMMDD(date)]\n        },\n        {},\n        {}\n      )}\n\t\t\t\t\t\t\t</td>`;\n    })}\n\t\t\t\t\t</tr><tr></tr>`;\n  })}</tbody></table></div>` : ``}`;\n});\nexport {\n  Page as default\n};\n"],"names":[],"mappings":"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"}