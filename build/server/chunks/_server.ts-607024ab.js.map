{"version":3,"file":"_server.ts-607024ab.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/users/reservations/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../../chunks/index.js\";\nimport { g as getXataClient } from \"../../../../../chunks/xata-old.js\";\nimport { c as convertFromXataToAppType } from \"../../../../../chunks/reservation.js\";\nimport { g as getXataUserDocWithFirebaseToken } from \"../../../../../chunks/firestore.js\";\nimport dayjs from \"dayjs\";\nimport timezone from \"dayjs/plugin/timezone.js\";\ndayjs.extend(timezone);\nconst xata = getXataClient();\nconst daysLimit = 60;\nasync function GET({ request }) {\n  try {\n    const now = dayjs().tz(\"Asia/Manila\");\n    const inXDays = now.clone().add(daysLimit, \"days\");\n    const dateArray = [];\n    let currentDate = now;\n    while (currentDate.isBefore(inXDays)) {\n      dateArray.push(currentDate.format(\"YYYY-MM-DD\"));\n      currentDate = currentDate.add(1, \"day\");\n    }\n    const xataUser = await getXataUserDocWithFirebaseToken(request.headers);\n    const rawRsvs = await xata.db.Reservations.filter({\n      // @ts-ignore\n      user: xataUser.id,\n      date: { $any: dateArray },\n      status: { $any: [\"confirmed\", \"pending\"] }\n    }).getAll();\n    const reservations = await convertFromXataToAppType(rawRsvs);\n    return json({ status: \"success\", reservations });\n  } catch (error) {\n    return json({ status: \"error\", error });\n  }\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACvB,MAAM,IAAI,GAAG,aAAa,EAAE,CAAC;AAC7B,MAAM,SAAS,GAAG,EAAE,CAAC;AACrB,eAAe,GAAG,CAAC,EAAE,OAAO,EAAE,EAAE;AAChC,EAAE,IAAI;AACN,IAAI,MAAM,GAAG,GAAG,KAAK,EAAE,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;AAC1C,IAAI,MAAM,OAAO,GAAG,GAAG,CAAC,KAAK,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;AACvD,IAAI,MAAM,SAAS,GAAG,EAAE,CAAC;AACzB,IAAI,IAAI,WAAW,GAAG,GAAG,CAAC;AAC1B,IAAI,OAAO,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;AAC1C,MAAM,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;AACvD,MAAM,WAAW,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;AAC9C,KAAK;AACL,IAAI,MAAM,QAAQ,GAAG,MAAM,+BAA+B,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AAC5E,IAAI,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC;AACtD;AACA,MAAM,IAAI,EAAE,QAAQ,CAAC,EAAE;AACvB,MAAM,IAAI,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE;AAC/B,MAAM,MAAM,EAAE,EAAE,IAAI,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC,EAAE;AAChD,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;AAChB,IAAI,MAAM,YAAY,GAAG,MAAM,wBAAwB,CAAC,OAAO,CAAC,CAAC;AACjE,IAAI,OAAO,IAAI,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,YAAY,EAAE,CAAC,CAAC;AACrD,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,IAAI,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;AAC5C,GAAG;AACH;;;;"}