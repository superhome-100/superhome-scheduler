{"version":3,"file":"server-8060eee8.js","sources":["../../../.svelte-kit/adapter-node/chunks/server.js"],"sourcesContent":["import { g as getXataClient } from \"./xata-old.js\";\nimport ObjectsToCsv from \"objects-to-csv\";\nimport JSZip from \"jszip\";\nconst xata = getXataClient();\nasync function getBackUpZip(branch) {\n  let zip = new JSZip();\n  let client = getXataClient(branch);\n  for (let tbl in client.db) {\n    if (Object.prototype.hasOwnProperty.call(client.db, tbl)) {\n      const records = await client.db[tbl].getAll();\n      const csv = new ObjectsToCsv(records);\n      const csvStr = await csv.toString();\n      zip.file(branch + \"/\" + tbl + \".csv\", csvStr);\n    }\n  }\n  return zip;\n}\nasync function getBuoys() {\n  const buoys = await xata.db.Buoys.getAll();\n  return buoys;\n}\nasync function getUserActiveNotifications(userId) {\n  const receipts = await xata.db.NotificationReceipts.filter({ user: userId }).getAll();\n  const notifications = await xata.db.Notifications.getAll();\n  return notifications.filter((ntf) => {\n    return receipts.filter((rpt) => {\n      return rpt?.notification?.id === ntf.id && rpt?.user?.id === userId;\n    }).length == 0;\n  });\n}\nasync function insertNotificationReceipt(notificationId, userId) {\n  const record = await xata.db.NotificationReceipts.create({\n    user: userId,\n    notification: notificationId\n  });\n  return record;\n}\nexport {\n  getBuoys as a,\n  getUserActiveNotifications as b,\n  getBackUpZip as g,\n  insertNotificationReceipt as i\n};\n"],"names":[],"mappings":";;;;AAGA,MAAM,IAAI,GAAG,aAAa,EAAE,CAAC;AAC7B,eAAe,YAAY,CAAC,MAAM,EAAE;AACpC,EAAE,IAAI,GAAG,GAAG,IAAI,KAAK,EAAE,CAAC;AACxB,EAAE,IAAI,MAAM,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC;AACrC,EAAE,KAAK,IAAI,GAAG,IAAI,MAAM,CAAC,EAAE,EAAE;AAC7B,IAAI,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,GAAG,CAAC,EAAE;AAC9D,MAAM,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC;AACpD,MAAM,MAAM,GAAG,GAAG,IAAI,YAAY,CAAC,OAAO,CAAC,CAAC;AAC5C,MAAM,MAAM,MAAM,GAAG,MAAM,GAAG,CAAC,QAAQ,EAAE,CAAC;AAC1C,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,GAAG,MAAM,EAAE,MAAM,CAAC,CAAC;AACpD,KAAK;AACL,GAAG;AACH,EAAE,OAAO,GAAG,CAAC;AACb,CAAC;AACD,eAAe,QAAQ,GAAG;AAC1B,EAAE,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;AAC7C,EAAE,OAAO,KAAK,CAAC;AACf,CAAC;AACD,eAAe,0BAA0B,CAAC,MAAM,EAAE;AAClD,EAAE,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,EAAE,CAAC,oBAAoB,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC;AACxF,EAAE,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;AAC7D,EAAE,OAAO,aAAa,CAAC,MAAM,CAAC,CAAC,GAAG,KAAK;AACvC,IAAI,OAAO,QAAQ,CAAC,MAAM,CAAC,CAAC,GAAG,KAAK;AACpC,MAAM,OAAO,GAAG,EAAE,YAAY,EAAE,EAAE,KAAK,GAAG,CAAC,EAAE,IAAI,GAAG,EAAE,IAAI,EAAE,EAAE,KAAK,MAAM,CAAC;AAC1E,KAAK,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC;AACnB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,eAAe,yBAAyB,CAAC,cAAc,EAAE,MAAM,EAAE;AACjE,EAAE,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,EAAE,CAAC,oBAAoB,CAAC,MAAM,CAAC;AAC3D,IAAI,IAAI,EAAE,MAAM;AAChB,IAAI,YAAY,EAAE,cAAc;AAChC,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,MAAM,CAAC;AAChB;;;;"}